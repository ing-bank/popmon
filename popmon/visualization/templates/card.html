<div class="col-md-{% if 'full_width' in metric %}12{% else %}6{% endif %} mb-5" >
    <a name="{% if feature%}{{ feature.name }}-{%endif%}{{ metric.name }}"></a>
    <div class="card shadow-sm">
        <div class="card-body" style="text-align: center">
            <h4 class="card-title">{{metric.name | fmt_metric}}</h4>
            {% if metric.description|length %}
                <p class="card-text">{{metric.description}}</p>
            {% endif %}
        </div>
        <div id= "{% if feature%}{{ feature.name }}-{%endif%}{{ metric.name }}"> </div>
        {% if (('Overview' in section_title) or ('traffic_light' in metric.type)) %}
            {{ metric.plot }}
        {% else %}
            <script>
                var observer = new IntersectionObserver(function(entries) {
                    if(entries[0].isIntersecting === true){
                        console.log("plotting graph");
                        {% if 'barplot' in metric.type %}
                            TESTER = document.getElementById("{% if feature%}{{ feature.name }}-{%endif%}{{ metric.name }}");
                            Plotly.newPlot(TESTER, JSON.parse('{{ metric.plot | tojson }}'), JSON.parse('{{ metric.layout | tojson }}'));
                        {% else %}
                            TESTER = document.getElementById("{% if feature%}{{ feature.name }}-{%endif%}{{ metric.name }}");
                            Plotly.newPlot(TESTER, JSON.parse('{{ metric.plot | tojson }}'), feature{{ section_index }}{{ curr }}_layout["{{ metric.type }}"]);
                        {% endif %}
                    }
                }, { threshold: [0] });

                observer.observe(document.getElementById("{% if feature%}{{ feature.name }}-{%endif%}{{ metric.name }}"));  
            </script>
        {% endif %} 
    </div>
</div>